<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="projects.wa_lch.title">WA-LCH | Niels de Laat</title>

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="../images/Favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../images/Favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../images/Favicon/favicon-16x16.png">
  <link rel="manifest" href="../images/Favicon/site.webmanifest">

  <meta name="description" data-i18n="projects.wa_lch.description" content="WA-LCH game project by Niels de Laat">
  <meta name="keywords" content="WA-LCH, game development, Unity, programming, portfolio">
  <meta name="author" content="Niels de Laat">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <link href="../css/prism.css" rel="stylesheet" />

  <script type="module" src="../components/navbar.js"></script>
  <script type="module" src="../components/social-buttons.js"></script>
  <script type="module" src="../components/code-block.js"></script>
  <script type="module" src="../js/translate.js"></script>
  <script type="module" src="../components/projectPageLayout.js"></script>
  <script type="module" src="../components/footer.js"></script>

  <link rel="icon" type="image/png" href="../images/Favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="../images/Favicon/favicon.svg" />
  <link rel="shortcut icon" href="../images/Favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="../images/Favicon/apple-touch-icon.png" />
  <link rel="manifest" href="../images/Favicon/site.webmanifest" />

  <script>
    // Lazy load Prism.js only when code blocks are visible
    const loadPrism = () => {
      if (window.Prism) return; // Already loaded
      const script = document.createElement('script');
      script.src = '../js/prism.js';
      script.onload = () => window.Prism?.highlightAll();
      document.head.appendChild(script);
    };

    // Intersection Observer for lazy loading
    const codeObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          loadPrism();
          codeObserver.disconnect(); // Only load once
        }
      });
    }, { rootMargin: '200px' });

    // Observe code blocks when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      const codeBlocks = document.querySelectorAll('pre code');
      if (codeBlocks.length > 0) {
        codeBlocks.forEach(block => codeObserver.observe(block));
      }
    });
  </script>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/ProjectPage.css" id="customStyles">

</head>

<body>
  <!-- Navigation Component -->
  <nav-bar></nav-bar>
  <!-- ============================================
       CONTENT CONFIGURATION - EDIT YOUR CONTENT HERE
       ============================================ -->
  <script id="projectConfig">
    const PROJECT_DATA = {
      // Project Info
      title: "Merge Packing",
      title_i18n: "__NO_TRANSLATE__",

      // Main Content Sections - with inline media and code block support
      sections: [
        {
          title: "Description",
          title_i18n: "projectPages.description",
          content: `Merge Packing is a quick, quirky mobile game built over a few days using Unity and C#. It features a unique merging mechanic inspired by puzzle games like Suika Game, with an alien twist: a cheerful alien drops randomized packing peanuts as you attempt to combine them into larger items.`,
          content_i18n: "projectPages.mergePacking.description"
        },
        {
          title: "What I Made",
          title_i18n: "projectPages.whatIMadeTitle",
          content_i18n: "__NO_TRANSLATE__"
        },
        {
          title: "Merging Logic",
          title_i18n: "projectPages.mergePacking.mergingLogic.mergingLogicTitle",
          content: "Merge Packing's primary mechanic revolves around combining two identical items into a higher-tier object. This is handled in the ObjectManager script:",
          content_i18n: "projectPages.mergePacking.mergingLogic.mergingLogicIntro"
        },
        {
          type: "media",
          mediaType: "video",
          src: "../videos/webm/MergePacking/MergePackingMerge.webm",
          height: "10%", // Corrected "hight" to "height" and adjusted the value
          width: "70%"   // Optional: Add a width property if needed
        },
        {
          type: "codeblock",
          githubUrl: "https://github.com/JoahvanderSloot/Packing-Merge/blob/main/Assets/_Project/Dev/Scripts/ObjectManager.cs#L56-L83",
          language: "csharp",
          buttonI18n: "projectPages.viewOnGitHub",
          buttonText: "View on github",
          buttonTitle: "View on GitHub",
          code: `
if (other == null || other.ObjectTypeIndex != ObjectTypeIndex) return;

Destroy(gameObject);
Destroy(collision.gameObject);

if (ObjectTypeIndex == itemPrefs.Count - 1)
{
    GameObject[] _peanutsArray = GameObject.FindGameObjectsWithTag("Peanut");

    foreach (GameObject _peanut in _peanutsArray)
    {
        Destroy(_peanut);
    }
}
else
{
    // ensure only one of the two runs the merge
    if (this.GetInstanceID() > collision.gameObject.GetInstanceID()) return;

    Vector2 middlePoint = Vector2.Lerp(transform.position, collision.transform.position, 0.5f);

    // spawn one merged object
    GameObject _newBall = Instantiate(itemPrefs[ObjectTypeIndex + 1], middlePoint, Quaternion.identity);
    _newBall.GetComponent().gravityScale = 1f;
}`
        },
        {
          title_i18n: "__NO_TRANSLATE__",
          content: 'The merging system checks for matching sprite types, ensures only one of the colliding objects spawns the new item in the middle of the 2 objects, and increases the score.',
          content_i18n: "projectPages.mergePacking.mergingLogic.mergingLogicEnd"
        },
        {
          title: "The alien",
          title_i18n: "projectPages.mergePacking.alien.alienTitle",
          content: "The alien is a floating alien creature that periodically swoops across the screen, dropping packing peanuts. Its motion is point-to-point, with smoothed directional transitions and dynamic behavior.",
          content_i18n: "projectPages.mergePacking.alien.alienIntro",
        },
        {
          type: "media",
          mediaType: "video",
          src: "../videos/webm/MergePacking/MergePackingalien.webm",
          height: "10%", // Corrected "hight" to "height" and adjusted the value
          width: "70%"
        },
        {
          type: "codeblock",
          githubUrl: "https://github.com/JoahvanderSloot/Packing-Merge/blob/main/Assets/_Project/Dev/Scripts/Gaylien.cs#L97-L99",
          language: "csharp",
          buttonI18n: "projectPages.viewOnGitHub",
          buttonText: "View on github",
          buttonTitle: "View on GitHub",
          code: `
desiredDirection = (points[pointIndex].position - transform.position).normalized;
direction = Vector2.Lerp(direction, desiredDirection, turnSpeed * Time.deltaTime);
transform.position += (Vector3)(direction * movespeed * Time.deltaTime);`
        },
        {
          title_i18n: "__NO_TRANSLATE__",
          content: "The alien's path resets after each score milestone, creating a rhythmic gameplay loop. Peanuts are dropped using a coroutine:",
          content_i18n: "projectPages.mergePacking.alien.alienCodeSnippet"
        },
        {
          type: "codeblock",
          githubUrl: "https://github.com/JoahvanderSloot/Packing-Merge/blob/main/Assets/_Project/Dev/Scripts/Gaylien.cs#L112-L123",
          language: "csharp",
          buttonI18n: "projectPages.viewOnGitHub",
          buttonText: "View on github",
          buttonTitle: "View on GitHub",
          code: `
IEnumerator DropPeanut()
{
    while (true)
    {
        yield return new WaitForSeconds(peanutDropSpeed);
        GameObject peanut = Instantiate(peanutPrefab, DropPoint.position, Quaternion.identity);
        peanut.GetComponent().sprite = peanutSprites[Random.Range(0, peanutSprites.Count)];
    }
}`
        },
      ],
      // Sidebar Content
      sidebar: {//localhost/Portfolio/projects/merge-packing-backup.html
        trailerUrl: "../videos/MergePackingVideowide.mp4",
        screenshots: [
          { src: "../images/webp/ProjectScreenShots/MergePacking/MergePackingScreenshot1.webp", alt: "WA-LCH Origins Screenshot 1" },
        ],
        socialButtons: [
          {
            url: "https://github.com/JoahvanderSloot/Packing-Merge/blob/main/Assets/_Project/Dev/Scripts/",
            icon: "fab fa-github",
            title: "View on GitHub",
            target: "_blank",
            rel: "noreferrer"
          }
        ]
      },

      // Embed (itch.io, etc)
      embed: {
        enabled: true,
        url: "https://itch.io/embed-upload/13820968?color=1E1E1E",
        playableOnMobile: true
      }
    };
  </script>

  <!-- Main Container -->
  <div class="container">
    <!-- Main Content -->
    <div class="main-content">
      <h1 class="gradient-title project-title" id="projectTitle"></h1>
      <div id="mainContent"></div>
      <div id="codeBlocks"></div>
      <div id="mediaContent"></div>

      <div id="embedSection"></div>
    </div>

    <!-- Divider -->
    <div class="divider"></div>

    <!-- Sidebar -->
    <div class="sidebar">
      <h2 class="gradient-title" data-i18n="projectPages.trailer">Trailer</h2>
      <div class="video-container" id="trailerContainer"></div>

      <h2 class="gradient-title" data-i18n="projectPages.screenshots">Screenshots</h2>
      <div id="screenshotsContainer"></div>

      <h2 class="gradient-title" data-i18n="projectPages.exploreCode">Explore Code</h2>
      <social-buttons id="exploreCodeButtons"></social-buttons>
    </div>
  </div>

  <!-- Image Modal -->
  <div id="imageModal" class="modal">
    <span class="modal-close">&times;</span>
    <img class="modal-content" id="modalImg" alt="Enlarged screenshot">
  </div>

  <!-- Footer -->

  <site-footer></site-footer>
  <!-- <p>Â© <span id="copyright-year"></span> <span id="footerName"></span>Niels de Laat</p> -->

</body>

</html>